(self.webpackChunknextjs_template=self.webpackChunknextjs_template||[]).push([[119],{"./node_modules/@bundled-es-modules/tough-cookie sync recursive":module=>{function webpackEmptyContext(req){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}webpackEmptyContext.keys=()=>[],webpackEmptyContext.resolve=webpackEmptyContext,webpackEmptyContext.id="./node_modules/@bundled-es-modules/tough-cookie sync recursive",module.exports=webpackEmptyContext},"./src/stories/OwnerRegistrationsPage.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DarkMode:()=>DarkMode,Default:()=>Default,EmptyState:()=>EmptyState,ErrorState:()=>ErrorState,LoadingState:()=>LoadingState,ReviewingRegistration:()=>ReviewingRegistration,__namedExportsOrder:()=>__namedExportsOrder,default:()=>OwnerRegistrationsPage_stories});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),mockNextAuth=__webpack_require__("./.storybook/mockNextAuth.ts"),mockToastify=__webpack_require__("./.storybook/mockToastify.ts"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),check=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/check.js"),x=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/x.js"),circle_alert=__webpack_require__("./node_modules/lucide-react/dist/esm/icons/circle-alert.js");function OwnerRegistrationsPage(){const[registrations,setRegistrations]=react.useState([]),[isLoading,setIsLoading]=react.useState(!0),[selectedId,setSelectedId]=react.useState(null),[notes,setNotes]=react.useState(""),fetchRegistrations=async()=>{try{const response=await fetch("/api/admin/owner-registrations");if(!response.ok)throw new Error("Failed to fetch registrations");const data=await response.json();setRegistrations(data)}catch(error){mockToastify.o.error("Failed to load registrations")}finally{setIsLoading(!1)}};react.useEffect((()=>{fetchRegistrations()}),[]);const handleAction=async(id,action)=>{try{if(!(await fetch(`/api/admin/owner-registrations/${id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({action,notes:notes.trim()||void 0})})).ok)throw new Error(`Failed to ${action} registration`);mockToastify.o.success(`Registration ${action}d successfully`),setSelectedId(null),setNotes(""),fetchRegistrations()}catch(error){mockToastify.o.error(`Failed to ${action} registration`)}};return isLoading?(0,jsx_runtime.jsx)("div",{className:"min-h-screen p-8",children:(0,jsx_runtime.jsx)("div",{className:"flex items-center justify-center",children:(0,jsx_runtime.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})})}):(0,jsx_runtime.jsx)("div",{className:"min-h-screen p-8",children:(0,jsx_runtime.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,jsx_runtime.jsx)("h1",{className:"text-2xl font-bold mb-8",children:"Owner Registration Requests"}),(0,jsx_runtime.jsx)("div",{className:"bg-white dark:bg-neutral-800 rounded-lg shadow overflow-hidden",children:(0,jsx_runtime.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,jsx_runtime.jsx)("thead",{className:"bg-gray-50 dark:bg-neutral-900",children:(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Name"}),(0,jsx_runtime.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Email"}),(0,jsx_runtime.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Building"}),(0,jsx_runtime.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Apartment"}),(0,jsx_runtime.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),(0,jsx_runtime.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Date"}),(0,jsx_runtime.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),(0,jsx_runtime.jsx)("tbody",{className:"bg-white dark:bg-neutral-800 divide-y divide-gray-200 dark:divide-gray-700",children:registrations.map((registration=>(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:registration.name}),(0,jsx_runtime.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:registration.email}),(0,jsx_runtime.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:registration.buildingNumber}),(0,jsx_runtime.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:registration.apartmentNumber}),(0,jsx_runtime.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,jsx_runtime.jsx)("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium\n                      ${"pending"===registration.status?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":""}\n                      ${"approved"===registration.status?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":""}\n                      ${"rejected"===registration.status?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":""}\n                    `,children:registration.status.charAt(0).toUpperCase()+registration.status.slice(1)})}),(0,jsx_runtime.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:new Date(registration.createdAt).toLocaleDateString()}),(0,jsx_runtime.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:["pending"===registration.status&&(0,jsx_runtime.jsx)("div",{className:"flex items-center justify-end space-x-2",children:selectedId===registration.id?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("textarea",{className:"block w-48 rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 text-sm",placeholder:"Add notes (optional)",value:notes,onChange:e=>setNotes(e.target.value)}),(0,jsx_runtime.jsx)("button",{onClick:()=>handleAction(registration.id,"approve"),className:"inline-flex items-center p-1 border border-transparent rounded-full text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:(0,jsx_runtime.jsx)(check.A,{className:"h-4 w-4"})}),(0,jsx_runtime.jsx)("button",{onClick:()=>handleAction(registration.id,"reject"),className:"inline-flex items-center p-1 border border-transparent rounded-full text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:(0,jsx_runtime.jsx)(x.A,{className:"h-4 w-4"})}),(0,jsx_runtime.jsx)("button",{onClick:()=>{setSelectedId(null),setNotes("")},className:"inline-flex items-center p-1 border border-gray-300 dark:border-gray-600 rounded-full text-gray-700 dark:text-gray-200 bg-white dark:bg-neutral-700 hover:bg-gray-50 dark:hover:bg-neutral-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:(0,jsx_runtime.jsx)(x.A,{className:"h-4 w-4"})})]}):(0,jsx_runtime.jsx)("button",{onClick:()=>setSelectedId(registration.id),className:"inline-flex items-center px-3 py-1 border border-transparent rounded-md text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Review"})}),registration.notes&&(0,jsx_runtime.jsxs)("div",{className:"mt-2 flex items-center justify-end text-xs text-gray-500 dark:text-gray-400",children:[(0,jsx_runtime.jsx)(circle_alert.A,{className:"h-3 w-3 mr-1"}),registration.notes]})]})]},registration.id)))})]})})]})})}OwnerRegistrationsPage.__docgenInfo={description:"",methods:[],displayName:"OwnerRegistrationsPage"};var http=__webpack_require__("./node_modules/msw/lib/core/http.mjs"),dist=__webpack_require__("./node_modules/@storybook/testing-library/dist/index.mjs"),jest_dist=__webpack_require__("./node_modules/@storybook/jest/dist/index.mjs");const mockRegistrations=[{id:"1",name:"John Doe",email:"john@example.com",buildingNumber:"A1",apartmentNumber:"101",phoneNumber:"+1 (555) 000-0001",status:"pending",createdAt:"2024-03-20T10:00:00.000Z"},{id:"2",name:"Jane Smith",email:"jane@example.com",buildingNumber:"B2",apartmentNumber:"202",phoneNumber:"+1 (555) 000-0002",status:"approved",createdAt:"2024-03-19T15:30:00.000Z",notes:"Verified through property records"},{id:"3",name:"Bob Wilson",email:"bob@example.com",buildingNumber:"C3",apartmentNumber:"303",phoneNumber:"+1 (555) 000-0003",status:"rejected",createdAt:"2024-03-18T09:15:00.000Z",notes:"Unable to verify ownership"}],OwnerRegistrationsPage_stories={title:"Pages/Admin/OwnerRegistrations",component:OwnerRegistrationsPage,parameters:{layout:"fullscreen",docs:{description:{component:"Admin interface for managing owner registration requests, including approval and rejection workflows."}},msw:{handlers:[http.L.get("/api/admin/owner-registrations",(()=>new Response(JSON.stringify(mockRegistrations),{headers:{"Content-Type":"application/json"}})))]}},decorators:[Story=>(0,jsx_runtime.jsxs)(mockNextAuth.CP,{session:{user:{id:"admin-user-id",email:"admin@costabeach.com",name:"Admin User",isAdmin:!0},expires:"1"},children:[(0,jsx_runtime.jsx)(Story,{}),(0,jsx_runtime.jsx)(mockToastify.N,{})]})],tags:["autodocs"]},Default={args:{},parameters:{docs:{description:{story:"The default view showing a mix of pending, approved, and rejected registrations."}}}},EmptyState={args:{},parameters:{msw:{handlers:[http.L.get("/api/admin/owner-registrations",(()=>new Response(JSON.stringify([]),{headers:{"Content-Type":"application/json"}})))]},docs:{description:{story:"The view when there are no registration requests to review."}}}},LoadingState={args:{},parameters:{msw:{handlers:[http.L.get("/api/admin/owner-registrations",(()=>new Response(JSON.stringify(mockRegistrations),{headers:{"Content-Type":"application/json"}})))]},docs:{description:{story:"The loading state while fetching registration data."}}}},ErrorState={args:{},parameters:{msw:{handlers:[http.L.get("/api/admin/owner-registrations",(()=>new Response(JSON.stringify(null),{status:500})))]},docs:{description:{story:"The error state when failing to fetch registration data."}}}},ReviewingRegistration={args:{},parameters:{docs:{description:{story:"Demonstrates the review process for a pending registration."}}},play:async({canvasElement})=>{const canvas=(0,dist.ux)(canvasElement),reviewButton=await canvas.findByText("Review");await dist.Q4.click(reviewButton);const notesTextarea=await canvas.findByPlaceholderText("Add notes (optional)");await(0,jest_dist.E)(notesTextarea).toBeInTheDocument(),await dist.Q4.type(notesTextarea,"Ownership verified through property records");const approveButton=canvas.getByRole("button",{name:""}),rejectButton=canvas.getByRole("button",{name:""});await(0,jest_dist.E)(approveButton).toBeInTheDocument(),await(0,jest_dist.E)(rejectButton).toBeInTheDocument()}},DarkMode={args:{},parameters:{themes:{default:"dark"},docs:{description:{story:"The admin interface in dark mode."}}}},__namedExportsOrder=["Default","EmptyState","LoadingState","ErrorState","ReviewingRegistration","DarkMode"];Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:'{\n  args: {},\n  parameters: {\n    docs: {\n      description: {\n        story: "The default view showing a mix of pending, approved, and rejected registrations."\n      }\n    }\n  }\n}',...Default.parameters?.docs?.source}}},EmptyState.parameters={...EmptyState.parameters,docs:{...EmptyState.parameters?.docs,source:{originalSource:"{\n  args: {},\n  parameters: {\n    msw: {\n      handlers: [http.get(\"/api/admin/owner-registrations\", () => {\n        return new Response(JSON.stringify([]), {\n          headers: {\n            'Content-Type': 'application/json'\n          }\n        });\n      })]\n    },\n    docs: {\n      description: {\n        story: \"The view when there are no registration requests to review.\"\n      }\n    }\n  }\n}",...EmptyState.parameters?.docs?.source}}},LoadingState.parameters={...LoadingState.parameters,docs:{...LoadingState.parameters?.docs,source:{originalSource:"{\n  args: {},\n  parameters: {\n    msw: {\n      handlers: [http.get(\"/api/admin/owner-registrations\", () => {\n        return new Response(JSON.stringify(mockRegistrations), {\n          headers: {\n            'Content-Type': 'application/json'\n          }\n        });\n      })]\n    },\n    docs: {\n      description: {\n        story: \"The loading state while fetching registration data.\"\n      }\n    }\n  }\n}",...LoadingState.parameters?.docs?.source}}},ErrorState.parameters={...ErrorState.parameters,docs:{...ErrorState.parameters?.docs,source:{originalSource:'{\n  args: {},\n  parameters: {\n    msw: {\n      handlers: [http.get("/api/admin/owner-registrations", () => {\n        return new Response(JSON.stringify(null), {\n          status: 500\n        });\n      })]\n    },\n    docs: {\n      description: {\n        story: "The error state when failing to fetch registration data."\n      }\n    }\n  }\n}',...ErrorState.parameters?.docs?.source}}},ReviewingRegistration.parameters={...ReviewingRegistration.parameters,docs:{...ReviewingRegistration.parameters?.docs,source:{originalSource:'{\n  args: {},\n  parameters: {\n    docs: {\n      description: {\n        story: "Demonstrates the review process for a pending registration."\n      }\n    }\n  },\n  play: async ({\n    canvasElement\n  }) => {\n    const canvas = within(canvasElement);\n\n    // Find and click the first "Review" button\n    const reviewButton = await canvas.findByText("Review");\n    await userEvent.click(reviewButton);\n\n    // Verify that the review form appears\n    const notesTextarea = await canvas.findByPlaceholderText("Add notes (optional)");\n    await expect(notesTextarea).toBeInTheDocument();\n\n    // Add some notes\n    await userEvent.type(notesTextarea, "Ownership verified through property records");\n\n    // Verify approve/reject buttons are present\n    const approveButton = canvas.getByRole("button", {\n      name: ""\n    }); // Using aria-label from Check icon\n    const rejectButton = canvas.getByRole("button", {\n      name: ""\n    }); // Using aria-label from X icon\n    await expect(approveButton).toBeInTheDocument();\n    await expect(rejectButton).toBeInTheDocument();\n  }\n}',...ReviewingRegistration.parameters?.docs?.source}}},DarkMode.parameters={...DarkMode.parameters,docs:{...DarkMode.parameters?.docs,source:{originalSource:'{\n  args: {},\n  parameters: {\n    themes: {\n      default: "dark"\n    },\n    docs: {\n      description: {\n        story: "The admin interface in dark mode."\n      }\n    }\n  }\n}',...DarkMode.parameters?.docs?.source}}}},"./.storybook/mockNextAuth.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{CI:()=>signOut,CP:()=>SessionProvider,Jv:()=>signIn,wV:()=>useSession});__webpack_require__("./node_modules/next/dist/compiled/react/index.js");const mockSession={data:{user:{name:"Test User",email:"test@example.com",image:"https://avatars.githubusercontent.com/u/1234567?v=4"},expires:"2099-10-10T00:00:00.000Z"},status:"authenticated"};function useSession(){return mockSession}function SessionProvider({children}){return children}function signIn(){return Promise.resolve({ok:!0,error:null})}function signOut(){return Promise.resolve({ok:!0})}},"./.storybook/mockToastify.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{N:()=>ToastContainer,o:()=>toast});var console=__webpack_require__("./node_modules/console-browserify/index.js");const toast={success:message=>console.log("Toast success:",message),error:message=>console.log("Toast error:",message),info:message=>console.log("Toast info:",message),warning:message=>console.log("Toast warning:",message)},ToastContainer=()=>null},"?4f7e":()=>{}}]);