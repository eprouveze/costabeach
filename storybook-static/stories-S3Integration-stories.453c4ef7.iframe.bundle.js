"use strict";(self.webpackChunknextjs_template=self.webpackChunknextjs_template||[]).push([[8253],{"./src/stories/S3Integration.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Documentation:()=>Documentation,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),_lib_i18n_client__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),__webpack_require__("./src/lib/i18n/client.tsx"));const __WEBPACK_DEFAULT_EXPORT__={title:"Documentation/S3 Integration",component:()=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"max-w-4xl mx-auto p-6",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"AWS S3 Integration Architecture"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"mb-4",children:"This document outlines the architecture and usage patterns for the AWS S3 integration in the Costa Beach HOA Portal."}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h2",{className:"text-2xl font-bold mt-8 mb-4",children:"Overview"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"mb-4",children:"The S3 integration provides secure file storage and retrieval capabilities for the HOA portal, allowing users to upload, download, and manage documents. The implementation follows best practices for security, performance, and error handling."}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h2",{className:"text-2xl font-bold mt-8 mb-4",children:"Configuration"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"mb-4",children:"The S3 integration is configured using environment variables:"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("ul",{className:"list-disc pl-6 mb-4",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("li",{className:"mb-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("code",{className:"bg-gray-100 px-1 py-0.5 rounded",children:"AWS_REGION"}),": The AWS region where the S3 bucket is located (default: ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("code",{className:"bg-gray-100 px-1 py-0.5 rounded",children:"us-west-2"}),")"]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("li",{className:"mb-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("code",{className:"bg-gray-100 px-1 py-0.5 rounded",children:"AWS_ACCESS_KEY_ID"}),": The AWS access key ID for authentication"]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("li",{className:"mb-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("code",{className:"bg-gray-100 px-1 py-0.5 rounded",children:"AWS_SECRET_ACCESS_KEY"}),": The AWS secret access key for authentication"]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("li",{className:"mb-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("code",{className:"bg-gray-100 px-1 py-0.5 rounded",children:"BUCKET_NAME"}),": The name of the S3 bucket (default: ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("code",{className:"bg-gray-100 px-1 py-0.5 rounded",children:"costa-beach-documents"}),")"]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("p",{className:"mb-4",children:["These values should be set in the ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("code",{className:"bg-gray-100 px-1 py-0.5 rounded",children:".env"})," file for local development and in the appropriate environment configuration for production deployments."]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h2",{className:"text-2xl font-bold mt-8 mb-4",children:"Architecture"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"mb-4",children:"The S3 integration consists of the following components:"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("h3",{className:"text-xl font-bold mt-6 mb-3",children:["1. Configuration (",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("code",{className:"bg-gray-100 px-1 py-0.5 rounded",children:"config.ts"}),")"]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("ul",{className:"list-disc pl-6 mb-4",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("li",{className:"mb-2",children:"Provides a centralized configuration for S3 services"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("li",{className:"mb-2",children:"Implements validation to ensure required environment variables are set"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("li",{className:"mb-2",children:"Creates and manages the S3 client instance"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("li",{className:"mb-2",children:"Provides utility functions for accessing configuration values"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("h3",{className:"text-xl font-bold mt-6 mb-3",children:["2. Operations (",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("code",{className:"bg-gray-100 px-1 py-0.5 rounded",children:"operations.ts"}),")"]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("ul",{className:"list-disc pl-6 mb-4",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("li",{className:"mb-2",children:"Implements file operations (upload, download, delete, list)"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("li",{className:"mb-2",children:"Provides secure URL generation for client-side uploads and downloads"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("li",{className:"mb-2",children:"Handles error cases gracefully with appropriate error messages"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("li",{className:"mb-2",children:"Implements file path generation and sanitization"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("h3",{className:"text-xl font-bold mt-6 mb-3",children:["3. Tests (",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("code",{className:"bg-gray-100 px-1 py-0.5 rounded",children:"__tests__/s3.test.ts"}),")"]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("ul",{className:"list-disc pl-6 mb-4",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("li",{className:"mb-2",children:"Provides comprehensive test coverage for configuration and operations"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("li",{className:"mb-2",children:"Mocks AWS SDK to enable testing without actual AWS credentials"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("li",{className:"mb-2",children:"Tests error handling and edge cases"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h2",{className:"text-2xl font-bold mt-8 mb-4",children:"Security Considerations"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"mb-4",children:"The S3 integration implements several security measures:"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("ol",{className:"list-decimal pl-6 mb-4",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("li",{className:"mb-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("strong",{children:"Signed URLs"}),": All file access is done through signed URLs that expire after a configurable time period (default: 1 hour)"]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("li",{className:"mb-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("strong",{children:"Path Sanitization"}),": File paths are sanitized to prevent path traversal attacks"]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("li",{className:"mb-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("strong",{children:"Content Type Validation"}),": File uploads include content type validation"]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("li",{className:"mb-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("strong",{children:"Error Handling"}),": All operations include proper error handling to prevent information leakage"]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h2",{className:"text-2xl font-bold mt-8 mb-4",children:"Usage Patterns"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h3",{className:"text-xl font-bold mt-6 mb-3",children:"Uploading Files"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"mb-4",children:"The file upload process follows a two-step approach:"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("ol",{className:"list-decimal pl-6 mb-4",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("li",{className:"mb-2",children:"The client requests a signed URL for uploading a specific file"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("li",{className:"mb-2",children:"The client uploads the file directly to S3 using the signed URL"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"mb-4",children:"This approach minimizes server load and allows for large file uploads without hitting API limits."}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"bg-gray-100 p-4 rounded-md mb-6 overflow-x-auto",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("pre",{className:"text-sm",children:"// Server-side: Generate upload URL\nconst { uploadUrl, filePath } = await getUploadUrl(\n  userId,\n  fileName,\n  fileType,\n  category,\n  language\n);\n\n// Client-side: Upload file using the signed URL\nawait fetch(uploadUrl, {\n  method: 'PUT',\n  body: fileData,\n  headers: {\n    'Content-Type': fileType\n  }\n});\n\n// Server-side: Create document record in database\nawait createDocument(\n  title,\n  description,\n  filePath,\n  fileSize,\n  fileType,\n  category,\n  language,\n  authorId\n);"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h3",{className:"text-xl font-bold mt-6 mb-3",children:"Downloading Files"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"mb-4",children:"File downloads also use signed URLs:"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"bg-gray-100 p-4 rounded-md mb-6 overflow-x-auto",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("pre",{className:"text-sm",children:"// Server-side: Generate download URL\nconst downloadUrl = await getDownloadUrl(document.filePath);\n\n// Client-side: Download file using the signed URL\nwindow.location.href = downloadUrl;"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h3",{className:"text-xl font-bold mt-6 mb-3",children:"File Management"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"mb-4",children:"The S3 integration provides functions for file management:"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"bg-gray-100 p-4 rounded-md mb-6 overflow-x-auto",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("pre",{className:"text-sm",children:"// Check if a file exists\nconst exists = await fileExists(filePath);\n\n// Delete a file\nawait deleteFile(filePath);\n\n// List files in a directory\nconst files = await listFiles('documents/legal/');"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h2",{className:"text-2xl font-bold mt-8 mb-4",children:"Error Handling"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"mb-4",children:"All S3 operations include comprehensive error handling:"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("ol",{className:"list-decimal pl-6 mb-4",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("li",{className:"mb-2",children:"Configuration errors are logged with clear messages"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("li",{className:"mb-2",children:"Operation errors are caught and transformed into user-friendly messages"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("li",{className:"mb-2",children:"Network errors are handled gracefully with appropriate retry mechanisms"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h2",{className:"text-2xl font-bold mt-8 mb-4",children:"Testing"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"mb-4",children:"The S3 integration includes comprehensive tests:"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"bg-gray-100 p-4 rounded-md mb-6 overflow-x-auto",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("pre",{className:"text-sm",children:"# Run S3 tests\nnpm test -- --testPathPattern=s3"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h2",{className:"text-2xl font-bold mt-8 mb-4",children:"CORS Configuration"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"mb-4",children:"The S3 bucket should be configured with appropriate CORS settings to allow direct uploads from the client. Here's an example CORS configuration:"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"bg-gray-100 p-4 rounded-md mb-6 overflow-x-auto",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("pre",{className:"text-sm",children:'[\n  {\n    "AllowedHeaders": ["*"],\n    "AllowedMethods": ["GET", "PUT", "POST", "DELETE"],\n    "AllowedOrigins": ["http://localhost:3000", "https://your-production-domain.com"],\n    "ExposeHeaders": ["ETag"]\n  }\n]'})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h2",{className:"text-2xl font-bold mt-8 mb-4",children:"Bucket Policy"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"mb-4",children:"The S3 bucket should have a policy that restricts access to authorized users only. Here's an example bucket policy:"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"bg-gray-100 p-4 rounded-md mb-6 overflow-x-auto",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("pre",{className:"text-sm",children:'{\n  "Version": "2012-10-17",\n  "Statement": [\n    {\n      "Effect": "Allow",\n      "Principal": {\n        "AWS": "arn:aws:iam::YOUR_ACCOUNT_ID:user/YOUR_IAM_USER"\n      },\n      "Action": [\n        "s3:GetObject",\n        "s3:PutObject",\n        "s3:DeleteObject",\n        "s3:ListBucket"\n      ],\n      "Resource": [\n        "arn:aws:s3:::YOUR_BUCKET_NAME",\n        "arn:aws:s3:::YOUR_BUCKET_NAME/*"\n      ]\n    }\n  ]\n}'})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h2",{className:"text-2xl font-bold mt-8 mb-4",children:"Conclusion"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"mb-4",children:"The S3 integration provides a secure, efficient, and reliable way to store and retrieve files for the Costa Beach HOA Portal. By following the patterns and practices outlined in this document, developers can ensure that file operations are performed securely and efficiently."})]}),parameters:{layout:"fullscreen"},decorators:[Story=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_lib_i18n_client__WEBPACK_IMPORTED_MODULE_2__.C,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Story,{})})]},Documentation={},__namedExportsOrder=["Documentation"];Documentation.parameters={...Documentation.parameters,docs:{...Documentation.parameters?.docs,source:{originalSource:"{}",...Documentation.parameters?.docs?.source}}}}}]);